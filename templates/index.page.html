{% extends 'base.page.html' %}

{% block content %}
<html data-theme="light">
<main class="hero grid-bg">
  <div class="hero-inner">
    <!-- Form Card -->
    <div style="background: white; border-radius: 12px; border: 1px solid #e9ecef; padding: 40px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); max-width: 480px; margin: 0 auto;">
      <div class="flex flex-col gap-8 justify-center items-center">
        <div class="info" style="text-align: center;">
          <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 8px;">Launch New Scraper</h2>
          <p style="color: #666; font-size: 14px; line-height: 1.5;">Select a scraper and enter the target ID to begin a new job.</p>
        </div>
        <form id="launchScraper" class="flex flex-col gap-4" style="width: 100%;" hx-post="/test2" hx-target="#response-div"
          hx-trigger="confirmed">
          <!-- Select + Input row -->
          <div class="flex gap-4">
            <select class="select select-bordered flex-1 indent-2" style="height: 48px; border: 2px solid #e9ecef; border-radius: 8px;" name="select_scraper" required>
              <option value="" disabled selected>Choose a scraper</option>
              <option value="option1">Product</option>
              <option value="option2">Image</option>
              <option value="option3">Metadata</option>
            </select>

            <input type="text" placeholder="Enter ID" class="input input-bordered flex-1 indent-2" style="height: 48px; border: 2px solid #e9ecef; border-radius: 8px;" name="input_id" required />
          </div>

          <!-- Submit button -->
          <button type="button" class="btn btn-primary w-full" style="height: 48px; border-radius: 8px; font-weight: 600;" onclick="confirmScrapLaunch()">
            Launch
          </button>
        </form>
      </div>
    </div>
  </div>
</main>

<section class="projects">
  <div class="projects-inner">
    <div class="index">01</div>
    <div class="projects-content">
      <h2>Projects</h2>
      <p>
        We are the creators, maintainers, and contributors of some of the most
        critical infrastructure projects in the JavaScript ecosystem.
      </p>
    </div>
    <div class="meta-file">projects.json</div>
  </div>
</section>

<div id="response-div"></div>

</html>
<script>
  function confirmScrapLaunch() {
    const form = document.getElementById('launchScraper');
    if (form.checkValidity()) {
    Swal.fire({
      title: "Confirm Scrap Launch",
      text: "This action cannot be undone.",
      icon: "question",
      showCancelButton: true
    }).then((result) => {
      if (result.isConfirmed) {
        htmx.trigger("#launchScraper", "confirmed");
      }
    });
  } else {
    form.reportValidity();
  }
  }

  document.body.addEventListener("itemAdded", function(evt){
    // evt.detail.scraper will contain "option1", etc.
    Swal.fire("Success!", "Started " + evt.detail.scraper, "success");
})
</script>
{% endblock %}